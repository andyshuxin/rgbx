{"version":3,"sources":["../app/scripts/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["(function(window, navigator, document, console) {\n\n  'use strict';\n\n  // =====================================\n  //\n  //        Define constants\n  //\n  // =====================================\n\n  const CANVAS_WIDTH  = 640;\n  const CANVAS_HEIGHT = 480;\n  const TETRACHROMACY_ADJUSTMENT_INDEX = 0.7; // Effective to enhance sensitivity on the red-yellow range\n\n  // =====================================\n  //\n  //        Create Colour Filters\n  //\n  // =====================================\n\n  // Generate a filter that just copies the input\n  const identicalLinearParameters = [\n  // R  G  B  - values from the camera\n    [1, 0, 0],  // R - linear coefficients\n    [0, 1, 0],  // G\n    [0, 0, 1]   // B\n  ];\n\n  const deuteranopiaLinearParameters = [\n    [ 0.43, 0.72, -0.15],\n    [ 0.34, 0.57, -0.09],\n    [-0.02, 0.03,  0.80]\n  ];\n\n  const add = (sum, operand) => sum + operand;\n\n  const matrixVectorProduct = (mat, vec) =>\n    mat.map(row =>\n            row.map((value, index) => value * vec[index])\n               .reduce(add));\n\n  const createSlowButConciseLinearFilter = parameterMatrix =>\n      data => {\n      for (let i = 0; i < data.length; i += 4) {\n        let pixelVec = [data[i], data[i + 1], data[i + 2]];\n        [data[i], data[i + 1], data[i + 2]] = matrixVectorProduct(parameterMatrix, pixelVec)\n      }\n    };\n\n  function createLinearFilter(parameterMatrix) {\n\n    return data => {\n\n      // This is just matrix multiplication: parameterMatrix * data\n\n      for (let i = 0; i < data.length; i += 4) {\n\n        const coefficient_RxR = parameterMatrix[0][0];\n        const coefficient_RxG = parameterMatrix[0][1];\n        const coefficient_RxB = parameterMatrix[0][2];\n        const coefficient_GxR = parameterMatrix[1][0];\n        const coefficient_GxG = parameterMatrix[1][1];\n        const coefficient_GxB = parameterMatrix[1][2];\n        const coefficient_BxR = parameterMatrix[2][0];\n        const coefficient_BxG = parameterMatrix[2][1];\n        const coefficient_BxB = parameterMatrix[2][2];\n\n        let r = data[i],\n            g = data[i + 1],\n            b = data[i + 2];\n\n        data[i    ] = coefficient_RxR * r + coefficient_RxG * g + coefficient_RxB * b;\n        data[i + 1] = coefficient_GxR * r + coefficient_GxG * g + coefficient_GxB * b;\n        data[i + 2] = coefficient_BxR * r + coefficient_BxG * g + coefficient_BxB * b;\n\n      }\n\n    };\n  }\n\n  // HSV functions from http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n\n  function rgbToHsv(r, g, b){\n    r = r/255, g = g/255, b = b/255;\n    var max = Math.max(r, g, b), min = Math.min(r, g, b);\n    var h, s, v = max;\n\n    var d = max - min;\n    s = max == 0 ? 0 : d / max;\n\n    if(max == min){\n      h = 0; // achromatic\n    }else{\n      switch(max){\n        case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n        case g: h = (b - r) / d + 2; break;\n        case b: h = (r - g) / d + 4; break;\n      }\n      h /= 6;\n    }\n\n    return [h, s, v];\n  }\n\n  function hsvToRgb(h, s, v){\n    var r, g, b;\n\n    var i = Math.floor(h * 6);\n    var f = h * 6 - i;\n    var p = v * (1 - s);\n    var q = v * (1 - f * s);\n    var t = v * (1 - (1 - f) * s);\n\n    switch(i % 6){\n      case 0: r = v, g = t, b = p; break;\n      case 1: r = q, g = v, b = p; break;\n      case 2: r = p, g = v, b = t; break;\n      case 3: r = p, g = q, b = v; break;\n      case 4: r = t, g = p, b = v; break;\n      case 5: r = v, g = p, b = q; break;\n    }\n\n    return [r * 255, g * 255, b * 255];\n  }\n\n  function createSpectrumShiftFilter(compress_index) {\n\n    return data => {\n\n      let r, g, b, h, s, v;\n\n      for (let i = 0; i < data.length; i += 4) {\n\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n        [h, s, v] = rgbToHsv(r, g, b);\n\n        h = Math.pow(h, compress_index);\n\n        [r, g, b] = hsvToRgb(h, s, v);\n        data[i]     = r;\n        data[i + 1] = g;\n        data[i + 2] = b;\n      }\n\n    }\n  }\n\n  function createSimpleDaltonizeFilter(deficiencyType='Deuteranope') {\n\n    // Ported from http://mudcu.be/labs/Color-Vision/Javascript/Color.Vision.Daltonize.js\n    // Original copyright notice:\n    /*\n     Color.Vision.Daltonize : v0.1\n     ------------------------------\n     \"Analysis of Color Blindness\" by Onur Fidaner, Poliang Lin and Nevran Ozguven.\n     http://scien.stanford.edu/class/psych221/projects/05/ofidaner/project_report.pdf\n\n     \"Digital Video Colourmaps for Checking the Legibility of Displays by Dichromats\" by FranÃ§oise ViÃ©not, Hans Brettel and John D. Mollon\n     http://vision.psychol.cam.ac.uk/jdmollon/papers/colourmaps.pdf\n     */\n\n    const CVDMatrix = { // Color Vision Deficiency\n      \"Protanope\": [ // reds are greatly reduced (1% men)\n        0.0, 2.02344, -2.52581,\n        0.0, 1.0,      0.0,\n        0.0, 0.0,      1.0\n      ],\n      \"Deuteranope\": [ // greens are greatly reduced (1% men)\n        1.0,      0.0, 0.0,\n        0.494207, 0.0, 1.24827,\n        0.0,      0.0, 1.0\n      ],\n      \"Tritanope\": [ // blues are greatly reduced (0.003% population)\n        1.0,       0.0,      0.0,\n        0.0,       1.0,      0.0,\n        -0.395913, 0.801109, 0.0\n      ]\n    };\n\n    let cvd = CVDMatrix[deficiencyType],\n        cvd_a = cvd[0],\n        cvd_b = cvd[1],\n        cvd_c = cvd[2],\n        cvd_d = cvd[3],\n        cvd_e = cvd[4],\n        cvd_f = cvd[5],\n        cvd_g = cvd[6],\n        cvd_h = cvd[7],\n        cvd_i = cvd[8];\n\n    return (data) => {\n\n      let l_input, m_input, s_input,\n          l, m, s,\n          r, g, b,\n          r_offset, g_offset, b_offset;\n\n      for (let i = 0, length = data.length; i < length; i += 4) {\n\n        let r_input = data[i],\n            g_input = data[i + 1],\n            b_input = data[i + 2];\n\n        // RGB to LMS matrix conversion\n        l_input = (17.8824 * r_input) + (43.5161 * g_input) + (4.11935 * b_input);\n        m_input = (3.45565 * r_input) + (27.1554 * g_input) + (3.86714 * b_input);\n        s_input = (0.0299566 * r_input) + (0.184309 * g_input) + (1.46709 * b_input);\n\n        // Simulate color blindness\n        l = (cvd_a * l_input) + (cvd_b * m_input) + (cvd_c * s_input);\n        m = (cvd_d * l_input) + (cvd_e * m_input) + (cvd_f * s_input);\n        s = (cvd_g * l_input) + (cvd_h * m_input) + (cvd_i * s_input);\n\n        // LMS to RGB matrix conversion\n        r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\n        g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\n        b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\n\n        // Isolate invisible colors to color vision deficiency (calculate error matrix)\n        r = r_input - r;\n        g = g_input - g;\n        b = b_input - b;\n\n        // Shift colors towards visible spectrum (apply error modifications)\n        r_offset = 0;\n        g_offset = (0.7 * r) + (1.0 * g);\n        b_offset = (0.7 * r) + b;\n\n        // Add compensation to original values\n        r = r_offset + r_input;\n        g = g_offset + g_input;\n        b = b_offset + b_input;\n\n        // Clamp values\n        if (r < 0) r = 0;\n        if (r > 255) r = 255;\n        if (g < 0) g = 0;\n        if (g > 255) g = 255;\n        if (b < 0) b = 0;\n        if (b > 255) b = 255;\n\n        // Record color\n        data[i    ] = r >> 0;\n        data[i + 1] = g >> 0;\n        data[i + 2] = b >> 0;\n      }\n\n    }\n  }\n\n  // Set up default filter\n  let filter = createLinearFilter(identicalLinearParameters);\n\n  // =====================================\n  //\n  //  Set up vendor-specific media input\n  //\n  // =====================================\n\n  const mediaErrorHandler = error => console.log(\"Video capture error: \", error);\n\n  const createStreamHandler = (videoNode, urlCreator) =>\n      stream => {\n        if (urlCreator === null) {\n          videoNode.src = stream;\n        } else {\n          videoNode.src = urlCreator(stream);\n        }\n        videoNode.play();\n      };\n\n  const videoDOMNode = document.getElementById(\"video\");\n  const videoConstraints = {\n    video: true,\n    audio: false\n  };\n  let funcGetUserMedia, vendorUrlCreator;\n\n  // Standard\n  if (navigator.getUserMedia) {\n    funcGetUserMedia = navigator.getUserMedia.bind(navigator);\n    vendorUrlCreator = null;\n    console.log('Using standard getUserMedia');\n\n  // Webkit-specific\n  } else if (navigator.webkitGetUserMedia) {\n    funcGetUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n    vendorUrlCreator = window.URL.createObjectURL;\n    console.log('Using Webkit getUserMedia');\n\n  // Gecko-specific\n  } else if (navigator.mozGetUserMedia) {\n    funcGetUserMedia = navigator.mozGetUserMedia.bind(navigator);\n    vendorUrlCreator = window.URL.createObjectURL;\n    console.log('Using Mozilla getUserMedia');\n  }\n\n  const streamHandler = createStreamHandler(videoDOMNode, vendorUrlCreator);\n  funcGetUserMedia(videoConstraints, streamHandler, mediaErrorHandler);\n\n  // =====================================\n  //\n  //     Set up canvas and establish\n  //  connection between canvas and video\n  //\n  // =====================================\n\n  const canvasDOMNode = document.getElementById('display');\n  const canvasContext = canvasDOMNode.getContext('2d');\n\n  const updateCanvasFrame = (videoNode, context, width, height) => {\n\n    const x0 = 0;\n    const y0 = 0;\n\n    if (videoNode.paused || videoNode.ended) {\n      return;\n    }\n\n    // Paint the frame onto the canvas\n    context.drawImage(videoNode, x0, y0, width, height);\n\n    // Apply filter to the image frame\n    let imageData = context.getImageData(x0, y0, width, height);\n    filter(imageData.data);\n    context.putImageData(imageData, x0, y0);\n\n    // Request for next frame\n    window.requestAnimationFrame(() => {\n      updateCanvasFrame(videoNode, context, width, height);\n    });\n  };\n\n  // Setup event listeners\n\n  videoDOMNode.addEventListener('play', () => {\n    updateCanvasFrame(videoDOMNode, canvasContext, CANVAS_WIDTH, CANVAS_HEIGHT);\n  });\n\n  let modeSelect = document.getElementById('modeSelect');\n  modeSelect.addEventListener('change', (event) => {\n    let option = event.target.value;\n\n    if (option === '3toDeuteranopia') {\n      filter = createLinearFilter(deuteranopiaLinearParameters);\n    } else if (option === '3toTetrachromacy') {\n      filter = createSpectrumShiftFilter(TETRACHROMACY_ADJUSTMENT_INDEX);\n    } else if (option === '3') {\n      filter = createLinearFilter(identicalLinearParameters);\n    } else if (option === '2to3') {\n      filter = createSimpleDaltonizeFilter();\n    }\n\n    updateCanvasFrame(videoDOMNode, canvasContext, CANVAS_WIDTH, CANVAS_HEIGHT);\n\n    console.log(option);\n  })\n\n\n\n}(window, window.navigator, window.document, window.console));"]}